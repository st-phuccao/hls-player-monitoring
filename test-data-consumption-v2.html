<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Data Consumption Tracker V2</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #0f172a;
            color: #f8fafc;
            padding: 20px;
        }

        .test-container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .test-button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        .test-button:hover {
            background: #1d4ed8;
        }

        .test-result {
            background: #1e293b;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #2563eb;
        }

        .warning {
            border-left-color: #f59e0b;
        }

        .success {
            border-left-color: #10b981;
        }

        .error {
            border-left-color: #ef4444;
        }

        pre {
            background: #334155;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 14px;
        }

        .step {
            background: #334155;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 3px solid #64748b;
        }
    </style>
</head>

<body>
    <div class="test-container">
        <h1>ğŸ§ª Test Data Consumption Tracker V2</h1>

        <div class="test-result success">
            <h3>âœ… CÃ¡c cáº£i tiáº¿n Ä‘Ã£ thá»±c hiá»‡n:</h3>
            <ul>
                <li>âœ… Táº¡o panel ngay khi khá»Ÿi táº¡o (khÃ´ng cáº§n Ä‘á»£i data)</li>
                <li>âœ… ThÃªm network interception Ä‘á»ƒ track táº¥t cáº£ HTTP requests</li>
                <li>âœ… ThÃªm nhiá»u HLS event listeners</li>
                <li>âœ… ThÃªm video element tracking cho buffer monitoring</li>
                <li>âœ… Cáº£i thiá»‡n debug logging vÃ  error handling</li>
                <li>âœ… ThÃªm comprehensive debug tools</li>
            </ul>
        </div>

        <div class="test-result">
            <h3>ğŸ”§ HÆ°á»›ng dáº«n test chi tiáº¿t:</h3>

            <div class="step">
                <strong>BÆ°á»›c 1:</strong> Má»Ÿ trang chÃ­nh (index.html) trong tab má»›i
            </div>

            <div class="step">
                <strong>BÆ°á»›c 2:</strong> Má»Ÿ Developer Console (F12)
            </div>

            <div class="step">
                <strong>BÆ°á»›c 3:</strong> Cháº¡y debug command chÃ­nh:
                <pre><code>debugDataConsumptionDetailed()</code></pre>
                Command nÃ y sáº½ kiá»ƒm tra táº¥t cáº£ cÃ¡c thÃ nh pháº§n vÃ  hiá»ƒn thá»‹ tráº¡ng thÃ¡i chi tiáº¿t
            </div>
        </div>

        <div class="test-result">
            <h3>ğŸ” Debug Commands Má»›i (cháº¡y trong console):</h3>

            <h4>1. ğŸ¯ Debug chi tiáº¿t (RECOMMENDED - cháº¡y Ä‘áº§u tiÃªn):</h4>
            <pre><code>debugDataConsumptionDetailed()</code></pre>
            <p>Kiá»ƒm tra toÃ n bá»™ há»‡ thá»‘ng, táº¡o panel náº¿u chÆ°a cÃ³, test simulation</p>

            <h4>2. ğŸ§ª Test táº¥t cáº£ methods tracking:</h4>
            <pre><code>testAllDataTracking()</code></pre>
            <p>Test táº¥t cáº£ cÃ¡c cÃ¡ch track data khÃ¡c nhau</p>

            <h4>3. ğŸ“Š Monitor real-time:</h4>
            <pre><code>const monitor = startDataConsumptionMonitoring(3000)
// Äá»ƒ dá»«ng: clearInterval(monitor)</code></pre>
            <p>Monitor data consumption má»—i 3 giÃ¢y</p>

            <h4>4. ğŸ¬ Test vá»›i stream tháº­t:</h4>
            <pre><code>testWithRealStream()</code></pre>
            <p>Load stream vÃ  monitor data trong 30 giÃ¢y</p>

            <h4>5. ğŸ”„ Debug commands cÅ© (váº«n hoáº¡t Ä‘á»™ng):</h4>
            <pre><code>debugDataConsumption()        // ThÃ´ng tin cÆ¡ báº£n
simulateDataLoading()         // MÃ´ phá»ng 2MB data
forceDataUpdate()            // Force update UI</code></pre>
        </div>

        <div class="test-result warning">
            <h3>âš ï¸ Váº¥n Ä‘á» hiá»‡n táº¡i vÃ  cÃ¡ch kháº¯c phá»¥c:</h3>

            <h4>Váº¥n Ä‘á»: Data consumption tháº¥p (chá»‰ ~112KB)</h4>
            <p><strong>NguyÃªn nhÃ¢n cÃ³ thá»ƒ:</strong></p>
            <ul>
                <li>HLS.js events khÃ´ng trigger Ä‘á»§ data</li>
                <li>Network interception chÆ°a hoáº¡t Ä‘á»™ng Ä‘Ãºng</li>
                <li>Video segments khÃ´ng Ä‘Æ°á»£c track</li>
            </ul>

            <p><strong>CÃ¡ch test:</strong></p>
            <ol>
                <li>Cháº¡y <code>debugDataConsumptionDetailed()</code> Ä‘á»ƒ xem tráº¡ng thÃ¡i</li>
                <li>Load má»™t stream vÃ  play video</li>
                <li>Cháº¡y <code>testWithRealStream()</code> Ä‘á»ƒ monitor</li>
                <li>Kiá»ƒm tra Network tab trong DevTools Ä‘á»ƒ xem requests</li>
            </ol>
        </div>

        <div class="test-result">
            <h3>ğŸ¯ Káº¿t quáº£ mong Ä‘á»£i sau khi sá»­a:</h3>
            <ul>
                <li>âœ… Panel "Data Consumption & Transfer" xuáº¥t hiá»‡n ngay</li>
                <li>âœ… Status: "Waiting for stream..." â†’ "Ready" â†’ "Active"</li>
                <li>âœ… Total Data Loaded tÄƒng khi play video (MB/GB level)</li>
                <li>âœ… Data Rate hiá»ƒn thá»‹ tá»‘c Ä‘á»™ transfer real-time</li>
                <li>âœ… Data Efficiency tÃ­nh MB/phÃºt chÃ­nh xÃ¡c</li>
                <li>âœ… Console logs hiá»ƒn thá»‹ fragment loading</li>
            </ul>
        </div>

        <div class="test-result error">
            <h3>ğŸ› Troubleshooting Steps:</h3>

            <h4>Náº¿u panel khÃ´ng xuáº¥t hiá»‡n:</h4>
            <pre><code>// Force táº¡o panel
if (dataConsumptionTracker) {
    dataConsumptionTracker.createDataPanel();
    dataConsumptionTracker.updateDataDisplay();
}</code></pre>

            <h4>Náº¿u data khÃ´ng tÄƒng khi play video:</h4>
            <pre><code>// Kiá»ƒm tra HLS events
if (hlsPlayer) {
    console.log('HLS levels:', hlsPlayer.levels);
    console.log('Current level:', hlsPlayer.currentLevel);
}

// Kiá»ƒm tra network requests trong DevTools Network tab
// TÃ¬m cÃ¡c requests .ts, .m3u8, .mp4</code></pre>

            <h4>Náº¿u váº«n khÃ´ng hoáº¡t Ä‘á»™ng:</h4>
            <ol>
                <li>Refresh trang vÃ  thá»­ láº¡i</li>
                <li>Kiá»ƒm tra console cÃ³ errors khÃ´ng</li>
                <li>Test vá»›i stream URL khÃ¡c</li>
                <li>Cháº¡y <code>simulateDataLoading()</code> Ä‘á»ƒ test UI</li>
            </ol>
        </div>

        <div class="test-result success">
            <h3>ğŸ“ˆ Test vá»›i stream tháº­t:</h3>
            <ol>
                <li>Paste URL stream vÃ o input field</li>
                <li>Click "Load Stream"</li>
                <li>Click play button</li>
                <li>Cháº¡y <code>startDataConsumptionMonitoring(2000)</code></li>
                <li>Quan sÃ¡t data tÄƒng trong console vÃ  dashboard</li>
                <li>Kiá»ƒm tra Network tab Ä‘á»ƒ xem HTTP requests</li>
            </ol>

            <p><strong>Stream test URLs:</strong></p>
            <pre><code>https://s2.phim1280.tv/20230919/sqojVKXO/2000kb/hls/index.m3u8
https://demo.unified-streaming.com/k8s/features/stable/video/tears-of-steel/tears-of-steel.ism/.m3u8</code></pre>
        </div>
    </div>
</body>

</html>